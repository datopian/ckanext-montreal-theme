<!-- This file keeps the new layout of the homepage -->
{% import "components.html" as components %}

{% set current_lang = request.environ.CKAN_LANG %}

<div id="main-container z-10" class="">

  {{components.page_hero({
    "title": _("Welcome to Montrealâ€™s open data website"),
    "description":"",
    "selectedSearchOption": '/'+current_lang+'/dataset',
    "query": "",
    "class" : "home-hero"
  })}}

  <div>
    <section class="flex flex-col mx-auto container pt-16">
      <div data-title="our-data">
        <h2 class="text-4xl text-zambezi text-dark font-semibold">
          {{ _('Our data') }}
        </h2>
      </div>
      <div data-title="collection-grid" class="flex">
        {% block featured_groups %} 
          {% snippet 'home/snippets/all_groups.html'%} 
        {% endblock %}
      </div>
    </section>
  </div>

  {# <------------- End of Our data Section -------------> #}

  <section class="px-4 mx-auto container">
    {# <------------------ Recently Updated datasets Section ---------------> #}
    <div class="pt-16 pb-16">
      <div class="flex items-center gap-4 mb-8">
        <h2 class="text-4xl text-zambezi text-dark font-semibold w-full ">
          {{ _('Datasets recently updated') }}
        </h2>
        {% set groups = h.all_groups() %} {% if groups|length > 0 %}
          <a
            class="view_all block w-fit text-center bg-transparent hover:bg-primary text-primary font-semibold hover:text-white py-2 px-4 border-1 border-gray-500 hover:border-transparent rounded-full"
            href="{{ h.url_for('dataset.search') }}"
            style="width:340px"
            >{{ _('View all datasets') }}</a
          >
        {% endif %}
      </div>
      <div class="grid-cols-3 grid gap-4">
        {% block featured_dataset %} {% snippet
        'home/snippets/latest_datasets.html' %} {% endblock %}
      </div>
    </div>
    {# <------------------ End of Recently Updated datasets Section --------->
    #} {# <------------------ News section ---------------> #}
    <div class="pt-16 pb-16">
      <h2 class="text-4xl text-zambezi text-dark font-semibold w-full">
        {{ _('News') }}
      </h2>
      {% snippet 'home/snippets/news.html' %}
      <a
          href="{{ h.url_for('pages.blog_index') }}"
          class="view_all block text-center  m-auto bg-transparent mt-8 mb-4 hover:bg-primary text-primary font-semibold hover:text-white mt-4 py-2 px-4 border-1 border-gray-500 hover:border-transparent rounded-full"
          style="width:fit-content"
          >
          {{ _('All News') }}
        </a>
    </div>
    {# <-------------- End of News section -------------> #} {#
    <------------------ Applications section ---------------> #}
    <div class="flex flex-col items-center pt-16 pb-16">
      <h2 class="text-4xl text-zambezi text-dark font-semibold w-full">
        {{ _('Applications') }}
      </h2>
      <div class="slick-showcase block flex w-full flex-row">
        {% block applications %} {% if h.get_showcases() %} {% snippet
        'home/snippets/showcase_list.html', showcases=h.get_showcases() %} {%
        endif %} {% endblock %}
      </div>
      <a
        href="{{ h.url_for('showcase_blueprint.index') }}"
        class="view_all text-center bg-transparent mb-4 hover:bg-primary text-primary font-semibold hover:text-white mt-4 py-2 px-4 border-1 border-gray-500 hover:border-transparent rounded-full"
      >
        {{ _('All Applications') }}
      </a>
    </div>
    {# <------------- End of Applications section -------------> #} {#
    <------------------ Organizations section ---------------> #}
    <div class="flex flex-col items-center pt-16 pb-16">
      <h2 class="text-4xl text-zambezi text-dark font-semibold w-full">
        {{ _('Organizations') }}
      </h2>
      <div data-title="collection-grid" class="flex w-full">
        {% block featured_organization %} {% snippet
        'home/snippets/all_organizations_homepage.html' %} {% endblock %}
      </div>

      {% set org = h.all_organizations() %} {% if org|length > 0 %} {% if
      g.userobj.sysadmin %}
      <a
        class="view_all text-center bg-transparent mb-4 hover:bg-primary text-primary font-semibold hover:text-white mt-2 py-2 px-4 border-1 border-gray-500 hover:border-transparent rounded-full"
        href="/dashboard/organizations"
        >{{ _('View all') }}</a
      >
      {% else %}
      <a
        class="view_all text-center bg-transparent mb-4 hover:bg-primary text-primary font-semibold hover:text-white mt-2 py-2 px-4 border-1 border-gray-500 hover:border-transparent rounded-full"
        href="{{ h.url_for('organization.index') }}"
        >{{ _('View all') }}</a
      >
      {% endif %} {% endif %}
    </div>
    {# <------------- End of Organizations section -------------> #}
  </section>

  {# <------------- Powered by section -------------> #}
  <div class="border-1"></div>
  <div class="px-4 mx-auto container pt-16 pb-32">
    <div class="flex justify-between items-center w-full">
      <div class="w-1/3">
        <a class="block w-24 font-bold" href="https://ckan.org/">
          <div class="text-xs mb-2">{{ _('Powered by') }}</div>
          <div class="text-xl">CKAN</div>
        </a>
      </div>
      <div class="w-2/3 text-base">
        <div class="mb-2">
          {{ _('By opening its data to everyone, the City of Montreal allows it to be reused for different purposes, including commercial purposes. The results of this reuse can then be shared in the community, which creates a multiplier effect.') }}
        </div>
        {% if current_lang == 'fr' %}
        <a class="text-primary font-bold" href="/pages/notre-demarche"
          >{{ _('Read our approach') }}</a
        >
        {% else %}
        <a class="text-primary font-bold" href="/pages/our-approach"
          >{{ _('Read our approach') }}</a
        >
        {% endif %}
      </div>
    </div>
  </div>
  {# <------------- End of Powered by section -------------> #}
</div>
